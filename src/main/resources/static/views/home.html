<div ng-controller="UserController as vm" class="user-view">

    <div class="user-is-not-authenticated" ng-show="!currentUser.userName">
        <div class="error">
            <p>Error message: not authenticated user!</p>
        <button class="btn btn-default" ng-click="vm.login()">Go to login page!</button>
        </div>
    </div>

    <div class="user-authenticated" ng-show="currentUser.userName">

        <div class="btn-group" role="group" ng-show="currentUser.admin">
            <button ng-click="vm.getAll()" type="button" class="btn btn-default">List all</button>
            <button ng-click="vm.getAdmins()" type="button" class="btn btn-default">List admins</button>
            <button type="button" class="btn btn-default" data-target="#addUserModal" data-toggle="modal">Add user</button>
        </div>


        <!--ADD USER MODAL-->
        <div class="modal fade" id="addUserModal" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <button class="close" data-dismiss="modal">&times;</button>
                        <h4 class="modal-title">Add user</h4>
                    </div>
                    <div class="modal-body">
                        <form role="form" name="addUserForm">
                            <div class="form-group">
                                <label>UserName</label>
                                <input name="username" type="text" placeholder="Name" class="form-control" required ng-model="addUser.name" required>
                            </div>
                            <div class="form-group" ng-class="{ 'has-error' : addUserForm.credits.$invalid && !addUserForm.credits.$pristine }">
                                <label>Credits</label>
                                <input name="credits" type="number" placeholder="Number of credits" class="form-control" required ng-model="addUser.credits" min="0" required>
                                <p class="error-message" ng-if="addUserForm.credits.$invalid && !addUserForm.credits.$pristine">min value is 0</p>
                            </div>
                            <div class="form-group">
                                <label>Password</label>
                                <input name="password" type="password" placeholder="Password" class="form-control" required ng-model="addUser.password" required>
                            </div>
                            {{message}}
                            <!-- majd később
                            <div class="form-group">
                                <label>Password again</label>
                                <input type="Password" placeholder="Password again" class="form-control" required ng-model="addUser.password2" required>
                            </div>
                            -->
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-primary" ng-disabled="addUserForm.$invalid" ng-click="vm.addUser(addUser)">Add</button>
                        <button class="btn btn-default" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>
        <!--END ADD USER MODAL-->

        <table class="table">
            <thead>
            <tr>
                <th>User</th>
                <th>Credits</th>
                <th>Role</th>
                <th style="width: 100px"></th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="user in vm.users">
                <td>{{user.userName}}</td>
                <td>{{user.userCredit}}</td>
                <td>
                    <div ng-show="user.admin">Admin</div>
                    <div ng-show="!user.admin">User</div>
                </td>
                <td ng-show="currentUser.admin || currentUser.userName == user.userName">
                    <button class="btn btn-success" ng-click="">Edit</button>
                </td>
                <td ng-show="!(currentUser.admin || currentUser.userName == user.userName)">
                </td>
                <td ng-show="currentUser.admin">
                    <button class="btn btn-danger" ng-click="vm.deleteUser(user.id)">Delete</button>
                </td>
                <td ng-show="!currentUser.admin">
                </td>
            </tr>
            </tbody>
        </table>

        <div ng-show="currentUser.userName">
            <p class="navbar-text navbar-right" style="margin-right: 10px;">Signed in as {{currentUser.userName}}</p>
            <button class="btn btn-default" ng-click="vm.logout()">Logout</button>
        </div>

    </div>

</div>